<div class="dashboard">
  <header class="topbar">
    <button class="hamburger" (click)="toggleMenu()">&#9776;</button>
    <div class="userinfo" *ngIf="user">
      {{ user.name }} - {{ user.company }}
    </div>
    <button class="logout" (click)="onLogout()">Cerrar sesión</button>
  </header>
  <div class="body">
    <nav class="sidemenu" [class.open]="menuOpen">
      <ul>
        <ng-template [ngTemplateOutlet]="tree" [ngTemplateOutletContext]="{ nodes: menuTree }"></ng-template>
        <li class="bottom-item" (click)="selectView('settings')" [class.active]="selectedView === 'settings'">
          <div class="menu-item">
            <span class="icon">&#9881;</span>
            <span>Configuración</span>
          </div>
        </li>
      </ul>
    </nav>
    <main class="content">
      <app-settings *ngIf="selectedView === 'settings'"></app-settings>
      <h2 *ngIf="selectedView === 'home'">Bienvenido al dashboard</h2>
    </main>
  </div>
</div>

<ng-template #tree let-nodes>
  <ng-container *ngFor="let node of nodes">
    <li>
      <div class="menu-item" (click)="toggleNode(node.id)">
        <span>{{ node.name }}</span>
        <span *ngIf="node.children && node.children.length" class="arrow" [class.open]="isOpen(node.id)">&#9654;</span>
      </div>
      <ul class="submenu" *ngIf="node.children && node.children.length" [class.open]="isOpen(node.id)">
        <ng-template [ngTemplateOutlet]="tree" [ngTemplateOutletContext]="{ nodes: node.children }"></ng-template>
      </ul>
    </li>
  </ng-container>
</ng-template>
